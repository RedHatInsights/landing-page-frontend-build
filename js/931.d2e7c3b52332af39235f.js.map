{"version":3,"sources":["webpack://landing-page-frontend/./src/store/contentReducer.js","webpack://landing-page-frontend/./src/App.js","webpack://landing-page-frontend/./src/store/action-types.js","webpack://landing-page-frontend/./src/store/actions.js","webpack://landing-page-frontend/./src/store/index.js","webpack://landing-page-frontend/./src/utils/content-generator.js"],"names":["contentMapper","endpoints","key","flatMap","actions","api","map","section","split","appName","version","startsWith","applyReducerHash","CALCULATE_ENDPOINTS","state","payload","loaded","LOAD_SECTIONS","sections","forEach","item","subSections","ref","includes","subSection","id","values","LOAD_CAROUSEL","carousel","LOAD_DATA","estate","recommendations","configTryLearn","Landing","lazy","Maintenance","NotFound","routes","landing","maintenance","PermissionContext","createContext","useState","isOrgAdmin","setIsOrgAdmin","dispatch","useDispatch","useEffect","getRegistry","register","technologies","technologiesReducer","contentStore","technologiesLoaded","activeTechnologies","endpointsAction","loadEndpoints","loadCarousel","loadSections","insights","chrome","init","identifyApp","window","auth","getUser","then","user","identity","is_org_admin","Provider","value","Suspense","fallback","Bullseye","Spinner","size","Switch","Route","exact","path","component","landingBeta","TECHOLOGIES","data","type","calculateEndpoints","loadData","middlewareListener","registry","MiddlewareListener","middleware","getMiddleware","promiseMiddleware","notificationsMiddleware","filter","notifications","notificationsReducer","calculatePermissions","permissions","Promise","all","flat","method","args","visibilityFunctions","visibility","every","Boolean","calculateVisibility","toCheck","isVisible","endpoint"],"mappings":"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","file":"js/931.d2e7c3b52332af39235f.js","sourcesContent":["import { applyReducerHash } from '@redhat-cloud-services/frontend-components-utilities/ReducerRegistry';\nimport {\n  CALCULATE_ENDPOINTS,\n  LOAD_CAROUSEL,\n  LOAD_SECTIONS,\n  LOAD_DATA,\n} from './action-types';\nimport flatMap from 'lodash/flatMap';\n\nconst contentMapper = (endpoints, key) =>\n  flatMap(endpoints, ({ actions, api }) =>\n    actions?.[key].map((section) => {\n      const [appName, version = 'v1'] = api.split('/');\n      return {\n        ...section,\n        api: `/api/${appName}/${version}${\n          (section?.api || '').startsWith('/') ? '' : '/'\n        }${section?.api || ''}`,\n      };\n    })\n  );\n\nexport function endpointsLoaded(state, { payload }) {\n  return {\n    ...state,\n    loaded: true,\n    endpoints: payload,\n  };\n}\n\nexport function sectionsLoader(state, { payload }) {\n  const sections = contentMapper(state?.endpoints, 'sections');\n  payload.forEach((item) => {\n    sections.forEach((section) => {\n      if (item?.subSections && section.ref.includes('.')) {\n        item?.subSections.forEach((subSection) => {\n          if (`${item.id}.${subSection.id}` === section.ref) {\n            subSection.values = [...(subSection.values || []), section];\n          }\n        });\n      }\n\n      if (item.id === section.ref) {\n        item.values = [...(item.values || []), section];\n      }\n    });\n  });\n  return {\n    ...state,\n    sections: payload,\n  };\n}\n\nexport function carouselLoader(state, { payload }) {\n  const carousel = contentMapper(state?.endpoints, 'carousel');\n  payload.forEach((item) => {\n    carousel.forEach((section) => {\n      if (item.id === section.ref) {\n        item.values = [...(item.values || []), section];\n      }\n    });\n  });\n  return {\n    ...state,\n    carousel: payload,\n  };\n}\n\n/**\n * This is here temporarily to quickly store and use content data before we optimize and split it\n */\nexport function loadAllContent(\n  state,\n  { payload: { estate, recommendations, configTryLearn } }\n) {\n  return {\n    ...state,\n    estate,\n    recommendations,\n    configTryLearn,\n  };\n}\n\nexport default applyReducerHash(\n  {\n    [`${CALCULATE_ENDPOINTS}_FULFILLED`]: endpointsLoaded,\n    [LOAD_SECTIONS]: sectionsLoader,\n    [LOAD_CAROUSEL]: carouselLoader,\n    [LOAD_DATA]: loadAllContent,\n  },\n  {\n    loaded: false,\n    endpoints: [],\n    carousel: [],\n    sections: [],\n    estate: [],\n    recommendations: [],\n    configTryLearn: [],\n  }\n);\n","import React, {\n  useEffect,\n  useState,\n  createContext,\n  lazy,\n  Suspense,\n} from 'react';\nimport { Switch, Route } from 'react-router-dom';\nimport { getRegistry } from '@redhat-cloud-services/frontend-components-utilities/Registry';\nimport { useDispatch } from 'react-redux';\nimport { Bullseye, Spinner } from '@patternfly/react-core';\nimport technologiesReducer from './store/technologiesReducer';\nimport contentStore from './store/contentReducer';\nimport {\n  technologiesLoaded,\n  loadEndpoints,\n  loadCarousel,\n  loadSections,\n} from './store/actions';\nimport { activeTechnologies } from './consts';\n\nconst Landing = lazy(() =>\n  import(/* webpackCunkName: \"Landing\" */ './routes/Landing')\n);\nconst Maintenance = lazy(() =>\n  import(/* webpackCunkName: \"Maintenance\" */ './routes/Maintenance')\n);\nconst NotFound = lazy(() =>\n  import(/* webpackCunkName: \"NotFound\" */ './routes/404')\n);\n\nimport './App.scss';\n\nconst routes = {\n  landing: '/',\n  maintenance: '/maintenance',\n};\n\nexport const PermissionContext = createContext();\n\nconst App = () => {\n  const [isOrgAdmin, setIsOrgAdmin] = useState();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    getRegistry().register({ technologies: technologiesReducer, contentStore });\n    dispatch(technologiesLoaded(activeTechnologies));\n    const endpointsAction = loadEndpoints();\n    dispatch(endpointsAction);\n    (async () => {\n      await endpointsAction.payload;\n      dispatch(loadCarousel());\n      dispatch(loadSections());\n    })();\n    insights.chrome.init();\n    insights.chrome.identifyApp('landing');\n    window.insights.chrome.auth\n      .getUser()\n      .then((user) => user && setIsOrgAdmin(user.identity.user.is_org_admin));\n  }, []);\n\n  return (\n    <PermissionContext.Provider value={{ isOrgAdmin }}>\n      <Suspense\n        fallback={\n          <Bullseye>\n            <Spinner size=\"xl\" />\n          </Bullseye>\n        }\n      >\n        <Switch>\n          <Route exact path={routes.landing} component={Landing} />\n          <Route exact path={routes.landingBeta} component={Landing} />\n          <Route exact path={routes.maintenance} component={Maintenance} />\n          <Route path=\"*\" component={NotFound} />\n        </Switch>\n      </Suspense>\n    </PermissionContext.Provider>\n  );\n};\n\nexport default App;\n","export const TECHOLOGIES = 'TECHNOLOGIES';\nexport const CALCULATE_ENDPOINTS = 'CALCULATE_ENDPOINTS';\nexport const LOAD_CAROUSEL = 'LOAD_CAROUSEL';\nexport const LOAD_SECTIONS = 'LOAD_SECTIONS';\nexport const LOAD_DATA = 'LOAD_DATA';\n","import {\n  TECHOLOGIES,\n  CALCULATE_ENDPOINTS,\n  LOAD_CAROUSEL,\n  LOAD_SECTIONS,\n  LOAD_DATA,\n} from './action-types';\nimport { endpoints, carousel, sections } from '../utils/config.json';\nimport { calculateEndpoints } from '../utils/content-generator';\n\nexport const technologiesLoaded = (data) => ({\n  type: TECHOLOGIES,\n  payload: data,\n});\n\nexport const loadEndpoints = () => ({\n  type: CALCULATE_ENDPOINTS,\n  payload: calculateEndpoints(endpoints),\n});\n\nexport const loadCarousel = () => ({\n  type: LOAD_CAROUSEL,\n  payload: carousel,\n});\n\nexport const loadSections = () => ({\n  type: LOAD_SECTIONS,\n  payload: sections,\n});\n\nexport const loadData = (data) => ({\n  type: LOAD_DATA,\n  payload: data,\n});\n","import MiddlewareListener from '@redhat-cloud-services/frontend-components-utilities/MiddlewareListener';\nimport { getRegistry } from '@redhat-cloud-services/frontend-components-utilities/Registry';\nimport notificationsMiddleware from '@redhat-cloud-services/frontend-components-notifications/notificationsMiddleware';\nimport { notificationsReducer } from '@redhat-cloud-services/frontend-components-notifications/redux';\nimport promiseMiddleware from 'redux-promise-middleware';\n\nlet middlewareListener;\nlet registry;\n\nexport function init(...middleware) {\n  middlewareListener = new MiddlewareListener();\n  registry = getRegistry({}, [\n    middlewareListener.getMiddleware(),\n    promiseMiddleware,\n    notificationsMiddleware(),\n    ...middleware.filter((item) => typeof item === 'function'),\n  ]);\n\n  registry.register({ notifications: notificationsReducer });\n  return registry;\n}\n\nexport function addNewListener({ actionType, callback }) {\n  return middlewareListener.addNew({\n    on: actionType,\n    callback,\n  });\n}\n","export const calculatePermissions = (permissions) =>\n  Promise.all(\n    [permissions]\n      .flat()\n      .map(({ method, args } = {}) =>\n        insights.chrome?.visibilityFunctions?.[method]?.(...(args || []))\n      )\n  ).then((visibility) => visibility.every(Boolean));\n\nexport const calculateVisibility = async (toCheck) => {\n  const data = await Promise.all(\n    toCheck?.map(async (item) => {\n      const isVisible = calculatePermissions(item?.permissions);\n      return isVisible && item;\n    }) || []\n  );\n\n  return data.filter(Boolean);\n};\n\nexport const calculateEndpoints = async (endpoints) => {\n  const data = await Promise.all(\n    endpoints.map(async (endpoint) => {\n      const isVisible = await calculatePermissions(endpoint?.permissions);\n      return (\n        isVisible && {\n          ...endpoint,\n          actions: {\n            carousel: await calculateVisibility(endpoint?.actions?.carousel),\n            sections: await calculateVisibility(endpoint?.actions?.sections),\n          },\n        }\n      );\n    })\n  );\n  return data.filter(Boolean);\n};\n"],"sourceRoot":""}