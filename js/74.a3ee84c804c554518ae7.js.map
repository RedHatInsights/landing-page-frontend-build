{"version":3,"sources":["webpack://landing-page-frontend/./src/store/contentReducer.js","webpack://landing-page-frontend/./src/utils/content-generator.js","webpack://landing-page-frontend/./src/App.js","webpack://landing-page-frontend/./src/store/actions.js","webpack://landing-page-frontend/./src/store/action-types.js","webpack://landing-page-frontend/./src/store/index.js"],"names":["contentMapper","endpoints","key","flatMap","actions","api","map","section","split","appName","version","startsWith","applyReducerHash","CALCULATE_ENDPOINTS","state","payload","loaded","LOAD_SECTIONS","sections","forEach","item","subSections","ref","includes","subSection","id","values","LOAD_CAROUSEL","carousel","calculatePermissions","permissions","Promise","all","flat","method","args","insights","chrome","visibilityFunctions","then","visibility","every","Boolean","calculateVisibility","toCheck","isVisible","data","filter","calculateEndpoints","endpoint","Landing","lazy","Maintenance","NotFound","routes","landing","maintenance","PermissionContext","createContext","useState","isOrgAdmin","setIsOrgAdmin","dispatch","useDispatch","useEffect","getRegistry","register","technologies","technologiesReducer","contentStore","activeTechnologies","type","TECHOLOGIES","endpointsAction","init","identifyApp","window","auth","getUser","user","identity","is_org_admin","Provider","value","Suspense","fallback","Bullseye","Spinner","size","Switch","Route","exact","path","component","landingBeta","middlewareListener","registry","MiddlewareListener","middleware","getMiddleware","promiseMiddleware","notificationsMiddleware","notifications"],"mappings":"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","file":"js/74.a3ee84c804c554518ae7.js","sourcesContent":["import { applyReducerHash } from '@redhat-cloud-services/frontend-components-utilities/files/cjs/ReducerRegistry';\nimport {\n  CALCULATE_ENDPOINTS,\n  LOAD_CAROUSEL,\n  LOAD_SECTIONS,\n} from './action-types';\nimport flatMap from 'lodash/flatMap';\n\nconst contentMapper = (endpoints, key) =>\n  flatMap(endpoints, ({ actions, api }) =>\n    actions?.[key].map((section) => {\n      const [appName, version = 'v1'] = api.split('/');\n      return {\n        ...section,\n        api: `/api/${appName}/${version}${\n          (section?.api || '').startsWith('/') ? '' : '/'\n        }${section?.api || ''}`,\n      };\n    })\n  );\n\nexport function endpointsLoaded(state, { payload }) {\n  return {\n    ...state,\n    loaded: true,\n    endpoints: payload,\n  };\n}\n\nexport function sectionsLoader(state, { payload }) {\n  const sections = contentMapper(state?.endpoints, 'sections');\n  payload.forEach((item) => {\n    sections.forEach((section) => {\n      if (item?.subSections && section.ref.includes('.')) {\n        item?.subSections.forEach((subSection) => {\n          if (`${item.id}.${subSection.id}` === section.ref) {\n            subSection.values = [...(subSection.values || []), section];\n          }\n        });\n      }\n\n      if (item.id === section.ref) {\n        item.values = [...(item.values || []), section];\n      }\n    });\n  });\n  return {\n    ...state,\n    sections: payload,\n  };\n}\n\nexport function carouselLoader(state, { payload }) {\n  const carousel = contentMapper(state?.endpoints, 'carousel');\n  payload.forEach((item) => {\n    carousel.forEach((section) => {\n      if (item.id === section.ref) {\n        item.values = [...(item.values || []), section];\n      }\n    });\n  });\n  return {\n    ...state,\n    carousel: payload,\n  };\n}\n\nexport default applyReducerHash(\n  {\n    [`${CALCULATE_ENDPOINTS}_FULFILLED`]: endpointsLoaded,\n    [LOAD_SECTIONS]: sectionsLoader,\n    [LOAD_CAROUSEL]: carouselLoader,\n  },\n  {\n    loaded: false,\n    endpoints: [],\n    carousel: [],\n    sections: [],\n  }\n);\n","export const calculatePermissions = (permissions) =>\n  Promise.all(\n    [permissions]\n      .flat()\n      .map(({ method, args } = {}) =>\n        insights.chrome?.visibilityFunctions?.[method]?.(...(args || []))\n      )\n  ).then((visibility) => visibility.every(Boolean));\n\nexport const calculateVisibility = async (toCheck) => {\n  const data = await Promise.all(\n    toCheck?.map(async (item) => {\n      const isVisible = calculatePermissions(item?.permissions);\n      return isVisible && item;\n    }) || []\n  );\n\n  return data.filter(Boolean);\n};\n\nexport const calculateEndpoints = async (endpoints) => {\n  const data = await Promise.all(\n    endpoints.map(async (endpoint) => {\n      const isVisible = await calculatePermissions(endpoint?.permissions);\n      return (\n        isVisible && {\n          ...endpoint,\n          actions: {\n            carousel: await calculateVisibility(endpoint?.actions?.carousel),\n            sections: await calculateVisibility(endpoint?.actions?.sections),\n          },\n        }\n      );\n    })\n  );\n  return data.filter(Boolean);\n};\n","import React, {\n  useEffect,\n  useState,\n  createContext,\n  lazy,\n  Suspense,\n} from 'react';\nimport { Switch, Route } from 'react-router-dom';\nimport { getRegistry } from '@redhat-cloud-services/frontend-components-utilities/files/cjs/Registry';\nimport { useDispatch } from 'react-redux';\nimport { Bullseye, Spinner } from '@patternfly/react-core';\nimport technologiesReducer from './store/technologiesReducer';\nimport contentStore from './store/contentReducer';\nimport {\n  technologiesLoaded,\n  loadEndpoints,\n  loadCarousel,\n  loadSections,\n} from './store/actions';\nimport { activeTechnologies } from './consts';\n\nconst Landing = lazy(() =>\n  import(/* webpackCunkName: \"Landing\" */ './routes/Landing')\n);\nconst Maintenance = lazy(() =>\n  import(/* webpackCunkName: \"Maintenance\" */ './routes/Maintenance')\n);\nconst NotFound = lazy(() =>\n  import(/* webpackCunkName: \"NotFound\" */ './routes/404')\n);\n\nimport './App.scss';\n\nconst routes = {\n  landing: '/',\n  maintenance: '/maintenance',\n};\n\nexport const PermissionContext = createContext();\n\nconst App = () => {\n  const [isOrgAdmin, setIsOrgAdmin] = useState();\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    getRegistry().register({ technologies: technologiesReducer, contentStore });\n    dispatch(technologiesLoaded(activeTechnologies));\n    const endpointsAction = loadEndpoints();\n    dispatch(endpointsAction);\n    (async () => {\n      await endpointsAction.payload;\n      dispatch(loadCarousel());\n      dispatch(loadSections());\n    })();\n    insights.chrome.init();\n    insights.chrome.identifyApp('landing');\n    window.insights.chrome.auth\n      .getUser()\n      .then((user) => user && setIsOrgAdmin(user.identity.user.is_org_admin));\n  }, []);\n\n  return (\n    <PermissionContext.Provider value={{ isOrgAdmin }}>\n      <Suspense\n        fallback={\n          <Bullseye>\n            <Spinner size=\"xl\" />\n          </Bullseye>\n        }\n      >\n        <Switch>\n          <Route exact path={routes.landing} component={Landing} />\n          <Route exact path={routes.landingBeta} component={Landing} />\n          <Route exact path={routes.maintenance} component={Maintenance} />\n          <Route path=\"*\" component={NotFound} />\n        </Switch>\n      </Suspense>\n    </PermissionContext.Provider>\n  );\n};\n\nexport default App;\n","import {\n  TECHOLOGIES,\n  CALCULATE_ENDPOINTS,\n  LOAD_CAROUSEL,\n  LOAD_SECTIONS,\n} from './action-types';\nimport { endpoints, carousel, sections } from '../utils/config.json';\nimport { calculateEndpoints } from '../utils/content-generator';\n\nexport const technologiesLoaded = (data) => ({\n  type: TECHOLOGIES,\n  payload: data,\n});\n\nexport const loadEndpoints = () => ({\n  type: CALCULATE_ENDPOINTS,\n  payload: calculateEndpoints(endpoints),\n});\n\nexport const loadCarousel = () => ({\n  type: LOAD_CAROUSEL,\n  payload: carousel,\n});\n\nexport const loadSections = () => ({\n  type: LOAD_SECTIONS,\n  payload: sections,\n});\n","export const TECHOLOGIES = 'TECHNOLOGIES';\nexport const CALCULATE_ENDPOINTS = 'CALCULATE_ENDPOINTS';\nexport const LOAD_CAROUSEL = 'LOAD_CAROUSEL';\nexport const LOAD_SECTIONS = 'LOAD_SECTIONS';\n","import MiddlewareListener from '@redhat-cloud-services/frontend-components-utilities/files/cjs/MiddlewareListener';\nimport { getRegistry } from '@redhat-cloud-services/frontend-components-utilities/files/cjs/Registry';\nimport notificationsMiddleware from '@redhat-cloud-services/frontend-components-notifications/cjs/notificationsMiddleware';\nimport notifications from '@redhat-cloud-services/frontend-components-notifications/cjs/notifications';\nimport promiseMiddleware from 'redux-promise-middleware';\n\nlet middlewareListener;\nlet registry;\n\nexport function init(...middleware) {\n  middlewareListener = new MiddlewareListener();\n  registry = getRegistry({}, [\n    middlewareListener.getMiddleware(),\n    promiseMiddleware,\n    notificationsMiddleware(),\n    ...middleware.filter((item) => typeof item === 'function'),\n  ]);\n\n  registry.register({ notifications });\n  return registry;\n}\n\nexport function addNewListener({ actionType, callback }) {\n  return middlewareListener.addNew({\n    on: actionType,\n    callback,\n  });\n}\n"],"sourceRoot":""}